#!/usr/local/opt/python/bin/python3.7
#This script was generated by the AMUSE framework
import sys
import os

if __name__ == '__main__':
    use_sockets = len(sys.argv) > 1
    if use_sockets:
        portnumber = int(sys.argv[1])
        host = sys.argv[2]
        usempi= sys.argv[3] == "true"
    else:
        usempi = True
        host = None
        portnumber = -1
        
    syspath = ('/usr/local/bin','/Users/webbjere/Codes/nbodypy/docs','/usr/local/lib/python3.7/site-packages','/usr/local/Cellar/python/3.7.4/Frameworks/Python.framework/Versions/3.7/lib/python37.zip','/usr/local/Cellar/python/3.7.4/Frameworks/Python.framework/Versions/3.7/lib/python3.7','/usr/local/Cellar/python/3.7.4/Frameworks/Python.framework/Versions/3.7/lib/python3.7/lib-dynload','/usr/local/lib/python3.7/site-packages','/usr/local/lib/python3.7/site-packages/future-0.17.1-py3.7.egg','/usr/local/lib/python3.7/site-packages/six-1.12.0-py3.7.egg','/usr/local/lib/python3.7/site-packages/pytest-5.0.1-py3.7.egg','/usr/local/lib/python3.7/site-packages/matplotlib-3.1.1-py3.7-macosx-10.14-x86_64.egg','/usr/local/lib/python3.7/site-packages/scipy-1.3.0-py3.7-macosx-10.14-x86_64.egg','/usr/local/lib/python3.7/site-packages/wcwidth-0.1.7-py3.7.egg','/usr/local/lib/python3.7/site-packages/py-1.8.0-py3.7.egg','/usr/local/lib/python3.7/site-packages/pluggy-0.12.0-py3.7.egg','/usr/local/lib/python3.7/site-packages/packaging-19.1-py3.7.egg','/usr/local/lib/python3.7/site-packages/more_itertools-7.2.0-py3.7.egg','/usr/local/lib/python3.7/site-packages/importlib_metadata-0.19-py3.7.egg','/usr/local/lib/python3.7/site-packages/attrs-19.1.0-py3.7.egg','/usr/local/lib/python3.7/site-packages/atomicwrites-1.3.0-py3.7.egg','/usr/local/lib/python3.7/site-packages/python_dateutil-2.8.0-py3.7.egg','/usr/local/lib/python3.7/site-packages/pyparsing-2.4.2-py3.7.egg','/usr/local/lib/python3.7/site-packages/kiwisolver-1.1.0-py3.7-macosx-10.14-x86_64.egg','/usr/local/lib/python3.7/site-packages/cycler-0.10.0-py3.7.egg','/usr/local/lib/python3.7/site-packages/zipp-0.5.2-py3.7.egg','/usr/local/lib/python3.7/site-packages/limepy-0.1.0-py3.7.egg','/usr/local/lib/python3.7/site-packages/gaia_tools-0.2-py3.7.egg','/usr/local/lib/python3.7/site-packages/tqdm-4.32.2-py3.7.egg','/usr/local/lib/python3.7/site-packages/astroquery-0.3.10.dev0-py3.7.egg','/usr/local/lib/python3.7/site-packages/html5lib-1.0.1-py3.7.egg','/usr/local/lib/python3.7/site-packages/beautifulsoup4-4.8.0-py3.7.egg','/usr/local/lib/python3.7/site-packages/keyring-19.0.2-py3.7.egg','/usr/local/lib/python3.7/site-packages/requests-2.22.0-py3.7.egg','/usr/local/lib/python3.7/site-packages/webencodings-0.5.1-py3.7.egg','/usr/local/lib/python3.7/site-packages/soupsieve-1.9.2-py3.7.egg','/usr/local/lib/python3.7/site-packages/entrypoints-0.3-py3.7.egg','/usr/local/lib/python3.7/site-packages/urllib3-1.25.3-py3.7.egg','/usr/local/lib/python3.7/site-packages/idna-2.8-py3.7.egg','/usr/local/lib/python3.7/site-packages/chardet-3.0.4-py3.7.egg','/usr/local/lib/python3.7/site-packages/certifi-2019.6.16-py3.7.egg','/usr/local/lib/python3.7/site-packages/periodictable-1.5.0-py3.7.egg','/usr/local/lib/python3.7/site-packages/isodist-1.-py3.7.egg','/Users/webbjere/Codes/apogee','/Users/webbjere/Codes/nbodypy','/usr/local/lib/python3.7/site-packages/nose-1.3.7-py3.7.egg','/Users/webbjere/Codes/galpy','/usr/local/lib/python3.7/site-packages/IPython/extensions')
    existing_syspath = set(sys.path)
    for x in syspath:
        if not x in existing_syspath:
              sys.path.append(x)
    
    if usempi:
        from mpi4py import MPI
        from amuse.rfi.channel import MpiChannel
        MpiChannel.ensure_mpi_initialized()

    from amuse.rfi import core

    from amuse.community.galactics.interface import GalactICsImplementation
    from amuse.community.galactics.interface import GalactICsInterface

    instance = GalactICsImplementation()

    from amuse.rfi.python_code import PythonImplementation

    x = PythonImplementation(instance, GalactICsInterface)
    
    if use_sockets:
        if usempi:
            x.start_socket_mpi(portnumber, host)
        else:
            x.start_socket(portnumber, host)
    else:
        x.start()
