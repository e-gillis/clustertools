
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>clustertools.util.plots &#8212; clustertools 0.1.dev1 documentation</title>
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">clustertools 0.1.dev1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for clustertools.util.plots</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot; A matplotlib.pyplot wrapper for making key StarCluster plots</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Jeremy J Webb&quot;</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;nscatter&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nplot&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nlplot&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nhist&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nhist2d&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ndens&quot;</span><span class="p">,</span>
    <span class="s2">&quot;starplot&quot;</span><span class="p">,</span>
    <span class="s2">&quot;skyplot&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">galpy.util</span> <span class="kn">import</span> <span class="n">bovy_plot</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">gaussian_filter</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">colors</span>


<span class="n">bovy_plot</span><span class="o">.</span><span class="n">bovy_print</span><span class="p">(</span><span class="n">axes_labelsize</span><span class="o">=</span><span class="mf">18.0</span><span class="p">,</span> <span class="n">xtick_labelsize</span><span class="o">=</span><span class="mf">14.0</span><span class="p">,</span> <span class="n">ytick_labelsize</span><span class="o">=</span><span class="mf">14.0</span><span class="p">)</span>
<span class="n">current_palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()</span>


<div class="viewcode-block" id="nscatter"><a class="viewcode-back" href="../../../reference/clustertools.util.plots.html#clustertools.util.plots.nscatter">[docs]</a><span class="k">def</span> <span class="nf">nscatter</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME:</span>

<span class="sd">       nscatter</span>

<span class="sd">    PURPOSE:</span>

<span class="sd">       Wrapper for matplotlib.pyplot.scatter that allows for most pyplot commands to be assigned when calling the function</span>

<span class="sd">    Parameters</span>

<span class="sd">       x,y - points to be plotted</span>

<span class="sd">       z - value for colour-coding</span>

<span class="sd">       xlabel - X-axis label</span>

<span class="sd">       ylabel - Y-axis label</span>

<span class="sd">       legend - Plot legend (Default: False)</span>

<span class="sd">       title - Title of plot</span>

<span class="sd">       xlim - X-axis limits</span>

<span class="sd">       ylim - Y-axis limits</span>

<span class="sd">       scale - if only xlim or ylim is given, set limits of axis to match points in given range</span>

<span class="sd">       filename - filename for savefig</span>

<span class="sd">       overplot - overplot onto existing figure (Default: False)</span>

<span class="sd">    KWARGS:</span>

<span class="sd">        same as matplotlib.pyplot</span>

<span class="sd">    Returns</span>

<span class="sd">       pyplot.figure()</span>

<span class="sd">    HISTORY:</span>

<span class="sd">       2018 - Written - Webb (UofT)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">overplot</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">overplot</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">out</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xlim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ylim</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale</span><span class="p">:</span>
                <span class="n">xindx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">xindx</span><span class="p">])</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">xindx</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">ylim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xlim</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale</span><span class="p">:</span>
                <span class="n">yindx</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">yindx</span><span class="p">])</span>
                <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">yindx</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span></div>


<div class="viewcode-block" id="nplot"><a class="viewcode-back" href="../../../reference/clustertools.util.plots.html#clustertools.util.plots.nplot">[docs]</a><span class="k">def</span> <span class="nf">nplot</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">ptype</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">logx</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">logy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME:</span>

<span class="sd">       nplot</span>

<span class="sd">    PURPOSE:</span>

<span class="sd">       Wrapper for plotting points with matplotlib.pyplot.plot that allows for most pyplot commands to be assigned when calling the function</span>

<span class="sd">    Parameters</span>

<span class="sd">       x,y - points to be plotted</span>

<span class="sd">       xlabel - X-axis label</span>

<span class="sd">       ylabel - Y-axis label</span>

<span class="sd">       legend - Plot legend (Default: False)</span>

<span class="sd">       title - Title of plot</span>

<span class="sd">       xlim - X-axis limits</span>

<span class="sd">       ylim - Y-axis limits</span>

<span class="sd">       scale - if only xlim or ylim is given, set limits of axis to match points in given range</span>

<span class="sd">       log - use log axis (Default: False)</span>

<span class="sd">       logx - use log x-axis (Default: False)</span>

<span class="sd">       logy - use log y-axis (Default: False)</span>

<span class="sd">       filename - filename for savefig</span>

<span class="sd">       overplot - overplot onto existing figure (Default: False)</span>

<span class="sd">    KWARGS:</span>

<span class="sd">        same as matplotlib.pyplot</span>

<span class="sd">    Returns</span>

<span class="sd">       pyplot.figure()</span>

<span class="sd">    HISTORY:</span>

<span class="sd">       2018 - Written - Webb (UofT)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">overplot</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">log</span> <span class="ow">or</span> <span class="p">(</span><span class="n">logx</span> <span class="ow">and</span> <span class="n">logy</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ptype</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">logx</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ptype</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">logy</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ptype</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ptype</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">overplot</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">out</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xlim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ylim</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale</span><span class="p">:</span>
                <span class="n">xindx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">xindx</span><span class="p">])</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">xindx</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">ylim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xlim</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale</span><span class="p">:</span>
                <span class="n">yindx</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">yindx</span><span class="p">])</span>
                <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">yindx</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span></div>


<div class="viewcode-block" id="nlplot"><a class="viewcode-back" href="../../../reference/clustertools.util.plots.html#clustertools.util.plots.nlplot">[docs]</a><span class="k">def</span> <span class="nf">nlplot</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">ltype</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">logx</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">logy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME:</span>

<span class="sd">       nlplot</span>

<span class="sd">    PURPOSE:</span>

<span class="sd">       Wrapper for plotting lines with matplotlib.pyplot.plot that allows for most pyplot commands to be assigned when calling the function</span>

<span class="sd">    Parameters</span>

<span class="sd">       x,y - points to be plotted</span>

<span class="sd">       ltype - line type</span>

<span class="sd">       xlabel - X-axis label</span>

<span class="sd">       ylabel - Y-axis label</span>

<span class="sd">       legend - Plot legend (Default: False)</span>

<span class="sd">       title - Title of plot</span>

<span class="sd">       xlim - X-axis limits</span>

<span class="sd">       ylim - Y-axis limits</span>

<span class="sd">       scale - if only xlim or ylim is given, set limits of axis to match points in given range</span>

<span class="sd">       log - use log axis (Default: False)</span>

<span class="sd">       logx - use log x-axis (Default: False)</span>

<span class="sd">       logy - use log y-axis (Default: False)</span>

<span class="sd">       filename - filename for savefig</span>

<span class="sd">       overplot - overplot onto existing figure (Default: False)</span>

<span class="sd">    KWARGS:</span>

<span class="sd">        same as matplotlib.pyplot</span>

<span class="sd">    Returns</span>

<span class="sd">       pyplot.figure()</span>

<span class="sd">    HISTORY:</span>

<span class="sd">       2018 - Written - Webb (UofT)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">nplot</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span>
        <span class="n">y</span><span class="p">,</span>
        <span class="n">ptype</span><span class="o">=</span><span class="n">ltype</span><span class="p">,</span>
        <span class="n">xlabel</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span>
        <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="n">xlim</span><span class="p">,</span>
        <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
        <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span>
        <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span>
        <span class="n">logy</span><span class="o">=</span><span class="n">logy</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
        <span class="n">overplot</span><span class="o">=</span><span class="n">overplot</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="nhist"><a class="viewcode-back" href="../../../reference/clustertools.util.plots.html#clustertools.util.plots.nhist">[docs]</a><span class="k">def</span> <span class="nf">nhist</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">nbin</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME:</span>

<span class="sd">       nhist</span>

<span class="sd">    PURPOSE:</span>

<span class="sd">       Wrapper for matplotlib.pyplot.hist that allows for most pyplot commands to be assigned when calling the function</span>

<span class="sd">    Parameters</span>

<span class="sd">       x - points to make histogram with</span>

<span class="sd">       nbin - number of bins</span>

<span class="sd">       xlabel - X-axis label</span>

<span class="sd">       legend - Plot legend (Default: False)</span>

<span class="sd">       title - Title of plot</span>

<span class="sd">       xlim - X-axis limits</span>

<span class="sd">       fill - Fill histogram bars</span>

<span class="sd">       filename - filename for savefig</span>

<span class="sd">       overplot - overplot onto existing figure (Default: False)</span>

<span class="sd">    KWARGS:</span>

<span class="sd">        same as matplotlib.pyplot</span>

<span class="sd">    Returns</span>

<span class="sd">       pyplot.figure()</span>

<span class="sd">    HISTORY:</span>

<span class="sd">       2018 - Written - Webb (UofT)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nbin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;bins&quot;</span><span class="p">,</span> <span class="n">nbin</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">overplot</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">fill</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">nbin</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">histtype</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;histtype&quot;</span><span class="p">,</span> <span class="s2">&quot;step&quot;</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">nbin</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="n">histtype</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">overplot</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">out</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xlim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span></div>


<div class="viewcode-block" id="nhist2d"><a class="viewcode-back" href="../../../reference/clustertools.util.plots.html#clustertools.util.plots.nhist2d">[docs]</a><span class="k">def</span> <span class="nf">nhist2d</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">nbin</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME:</span>

<span class="sd">       nhist2d</span>

<span class="sd">    PURPOSE:</span>

<span class="sd">       Wrapper for matplotlib.pyplot.nhist2d that allows for most pyplot commands to be assigned when calling the function</span>

<span class="sd">    Parameters</span>

<span class="sd">       x, y - points to make histogram with</span>

<span class="sd">       nbin - number of bins</span>

<span class="sd">       xlabel - X-axis label</span>

<span class="sd">       ylabel - Y-axis label</span>

<span class="sd">       title - Title of plot</span>

<span class="sd">       xlim - X-axis limits</span>

<span class="sd">       ylim - Y-axis limits</span>

<span class="sd">       filename - filename for savefig</span>

<span class="sd">       overplot - overplot onto existing figure (Default: False)</span>

<span class="sd">    KWARGS:</span>

<span class="sd">        same as matplotlib.pyplot</span>

<span class="sd">    Returns</span>

<span class="sd">       pyplot.figure()</span>

<span class="sd">    HISTORY:</span>

<span class="sd">       2018 - Written - Webb (UofT)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">xlim</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">ylim</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;cmap&quot;</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">)</span>

    <span class="n">out</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">nbin</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">out</span></div>


<div class="viewcode-block" id="ndens"><a class="viewcode-back" href="../../../reference/clustertools.util.plots.html#clustertools.util.plots.ndens">[docs]</a><span class="k">def</span> <span class="nf">ndens</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">normed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">xstep</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">ystep</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">sigx</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
    <span class="n">sigy</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>
    <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">extent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Spectral&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME:</span>

<span class="sd">       histogram2d</span>

<span class="sd">    PURPOSE:</span>

<span class="sd">       Wrapper for matplotlib.pyplot.histogram2d that allows for most pyplot commands to be assigned when calling the function</span>

<span class="sd">    Parameters</span>

<span class="sd">       x, y - points to make histogram with</span>

<span class="sd">       z - value for colour-coding</span>

<span class="sd">       normed - normalize </span>

<span class="sd">       xstep - step size between xbins</span>

<span class="sd">       ystep - step size between ybins</span>

<span class="sd">       sigx/sigy - dispersion for Gaussian filter</span>

<span class="sd">       order - order of Gaussian filter</span>

<span class="sd">       extent - axis range for imshow</span>

<span class="sd">       interpolation - interpolation type for imshow</span>

<span class="sd">       cmap - colour map for imshow</span>

<span class="sd">    Returns</span>

<span class="sd">       pyplot.figure()</span>

<span class="sd">    HISTORY:</span>

<span class="sd">       2018 - Written - Webb (UofT)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xbins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="n">xstep</span><span class="p">,</span> <span class="n">xstep</span><span class="p">)</span>
    <span class="n">ybins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="n">ystep</span><span class="p">,</span> <span class="n">ystep</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">H</span><span class="p">,</span> <span class="n">xedges</span><span class="p">,</span> <span class="n">yedges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="n">xbins</span><span class="p">,</span> <span class="n">ybins</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">H</span><span class="p">,</span> <span class="n">xedges</span><span class="p">,</span> <span class="n">yedges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="n">xbins</span><span class="p">,</span> <span class="n">ybins</span><span class="p">],</span> <span class="n">normed</span><span class="o">=</span><span class="n">normed</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">z</span>
        <span class="p">)</span>

    <span class="n">fimg</span> <span class="o">=</span> <span class="n">gaussian_filter</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="p">(</span><span class="n">sigx</span><span class="p">,</span> <span class="n">sigy</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">extent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>

    <span class="n">out</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
        <span class="n">fimg</span><span class="p">,</span>
        <span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(),</span>
        <span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">out</span></div>


<div class="viewcode-block" id="starplot"><a class="viewcode-back" href="../../../reference/clustertools.util.plots.html#clustertools.util.plots.starplot">[docs]</a><span class="k">def</span> <span class="nf">starplot</span><span class="p">(</span>
    <span class="n">cluster</span><span class="p">,</span>
    <span class="n">coords</span><span class="o">=</span><span class="s2">&quot;xyz&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">do_centre</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME:</span>

<span class="sd">       starplot</span>

<span class="sd">    PURPOSE:</span>

<span class="sd">       Plot the xy/xz/yz coordinates of each star in the cluster</span>

<span class="sd">    Parameters</span>

<span class="sd">       cluster - StarCluster instance</span>

<span class="sd">       coords - coordinates to be plotted (&#39;xy&#39;,&#39;xz&#39;,&#39;yz&#39;,&#39;xyz&#39;) (Default: &#39;xyz&#39; returns a two panel plot)</span>

<span class="sd">       xlim - X-axis limits</span>

<span class="sd">       ylim - Y-axis limits</span>

<span class="sd">       legend - Plot legend (Default: False)</span>

<span class="sd">       filename - filename for savefig</span>

<span class="sd">       overplot - overplot onto existing figure (Default: False)</span>

<span class="sd">       do_centre - plot centre of cluster (Default:False)</span>

<span class="sd">    KWARGS:</span>

<span class="sd">        same as matplotlib.pyplot</span>

<span class="sd">    Returns</span>

<span class="sd">       pyplot.figure()</span>

<span class="sd">    HISTORY:</span>

<span class="sd">       2018 - Written - Webb (UofT)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">coords</span> <span class="o">!=</span> <span class="s2">&quot;xyz&quot;</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">overplot</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">coords</span> <span class="o">==</span> <span class="s2">&quot;xz&quot;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">x</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">z</span>
            <span class="k">if</span> <span class="n">do_centre</span><span class="p">:</span>
                <span class="n">xgc</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">xgc</span>
                <span class="n">ygc</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">zgc</span>
        <span class="k">elif</span> <span class="n">coords</span> <span class="o">==</span> <span class="s2">&quot;yz&quot;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">y</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">z</span>
            <span class="k">if</span> <span class="n">do_centre</span><span class="p">:</span>
                <span class="n">xgc</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">ygc</span>
                <span class="n">ygc</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">zgc</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">x</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">y</span>
            <span class="k">if</span> <span class="n">do_centre</span><span class="p">:</span>
                <span class="n">xgc</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">xgc</span>
                <span class="n">ygc</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">ygc</span>

        <span class="n">out</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">overplot</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">out</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">do_centre</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xgc</span><span class="p">,</span> <span class="n">ygc</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;COM&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cluster</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;nbody&quot;</span><span class="p">:</span>
                <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;(NBODY)&quot;</span>
            <span class="k">elif</span> <span class="n">cluster</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;pckms&quot;</span><span class="p">:</span>
                <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;(pc)&quot;</span>
            <span class="k">elif</span> <span class="n">cluster</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;kpckms&quot;</span><span class="p">:</span>
                <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;(kpc)&quot;</span>
            <span class="k">elif</span> <span class="n">cluster</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;galpy&quot;</span><span class="p">:</span>
                <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;(GALPY)&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

            <span class="k">if</span> <span class="n">coords</span> <span class="o">==</span> <span class="s2">&quot;xz&quot;</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">x</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">z</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X &quot;</span> <span class="o">+</span> <span class="n">units</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Z &quot;</span> <span class="o">+</span> <span class="n">units</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">coords</span> <span class="o">==</span> <span class="s2">&quot;yz&quot;</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">y</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">z</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Y &quot;</span> <span class="o">+</span> <span class="n">units</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Z &quot;</span> <span class="o">+</span> <span class="n">units</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">x</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">y</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X &quot;</span> <span class="o">+</span> <span class="n">units</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Y &quot;</span> <span class="o">+</span> <span class="n">units</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Time = </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cluster</span><span class="o">.</span><span class="n">tphys</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">xlim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ylim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">out</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">cluster</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;nbody&quot;</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;(NBODY)&quot;</span>
        <span class="k">elif</span> <span class="n">cluster</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;pckms&quot;</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;(pc)&quot;</span>
        <span class="k">elif</span> <span class="n">cluster</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;kpckms&quot;</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;(kpc)&quot;</span>
        <span class="k">elif</span> <span class="n">cluster</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;galpy&quot;</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;(GALPY)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">cluster</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cluster</span><span class="o">.</span><span class="n">origin</span> <span class="o">==</span> <span class="s2">&quot;galaxy&quot;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">xgc</span><span class="p">,</span> <span class="n">cluster</span><span class="o">.</span><span class="n">zgc</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Center&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">xgc</span> <span class="o">+</span> <span class="n">cluster</span><span class="o">.</span><span class="n">xc</span><span class="p">,</span> <span class="n">cluster</span><span class="o">.</span><span class="n">zgc</span> <span class="o">+</span> <span class="n">cluster</span><span class="o">.</span><span class="n">zc</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;COM&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">cluster</span><span class="o">.</span><span class="n">origin</span> <span class="o">!=</span> <span class="s2">&quot;centre&quot;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">xc</span><span class="p">,</span> <span class="n">cluster</span><span class="o">.</span><span class="n">zc</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;COM&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xlim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ylim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X &quot;</span> <span class="o">+</span> <span class="n">units</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Z &quot;</span> <span class="o">+</span> <span class="n">units</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">cluster</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cluster</span><span class="o">.</span><span class="n">origin</span> <span class="o">==</span> <span class="s2">&quot;galaxy&quot;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">xgc</span><span class="p">,</span> <span class="n">cluster</span><span class="o">.</span><span class="n">ygc</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Center&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">xgc</span> <span class="o">+</span> <span class="n">cluster</span><span class="o">.</span><span class="n">xc</span><span class="p">,</span> <span class="n">cluster</span><span class="o">.</span><span class="n">ygc</span> <span class="o">+</span> <span class="n">cluster</span><span class="o">.</span><span class="n">yc</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;COM&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">cluster</span><span class="o">.</span><span class="n">origin</span> <span class="o">!=</span> <span class="s2">&quot;centre&quot;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">xc</span><span class="p">,</span> <span class="n">cluster</span><span class="o">.</span><span class="n">yc</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;COM&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xlim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ylim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X &quot;</span> <span class="o">+</span> <span class="n">units</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Y &quot;</span> <span class="o">+</span> <span class="n">units</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="skyplot"><a class="viewcode-back" href="../../../reference/clustertools.util.plots.html#clustertools.util.plots.skyplot">[docs]</a><span class="k">def</span> <span class="nf">skyplot</span><span class="p">(</span>
    <span class="n">cluster</span><span class="p">,</span>
    <span class="n">coords</span><span class="o">=</span><span class="s2">&quot;radec&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">overplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">do_centre</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME:</span>

<span class="sd">       skyplot</span>

<span class="sd">    PURPOSE:</span>

<span class="sd">       Plot the ra/dec or pmra/pmdec coordinates of each star in the cluster</span>

<span class="sd">    Parameters</span>

<span class="sd">       cluster - StarCluster instance</span>

<span class="sd">       coords - coordinates to be plotted (&#39;radec&#39;,&#39;pm&#39;) (Default: &#39;radec&#39;)</span>

<span class="sd">       xlim - X-axis limits</span>

<span class="sd">       ylim - Y-axis limits</span>

<span class="sd">       legend - Plot legend (Default: False)</span>

<span class="sd">       filename - filename for savefig</span>

<span class="sd">       overplot - overplot onto existing figure (Default: False)</span>

<span class="sd">       do_centre - plot centre of cluster (Default:False)</span>

<span class="sd">    KWARGS:</span>

<span class="sd">        same as matplotlib.pyplot</span>

<span class="sd">    Returns</span>

<span class="sd">       pyplot.figure()</span>

<span class="sd">    HISTORY:</span>

<span class="sd">       2019 - Written - Webb (UofT)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">units0</span><span class="p">,</span> <span class="n">origin0</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">units</span><span class="p">,</span><span class="n">cluster</span><span class="o">.</span><span class="n">origin</span>

    <span class="n">cluster</span><span class="o">.</span><span class="n">to_radec</span><span class="p">()</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">overplot</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">coords</span> <span class="o">==</span> <span class="s2">&quot;radec&quot;</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">ra</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">dec</span>
    <span class="k">elif</span> <span class="n">coords</span> <span class="o">==</span> <span class="s2">&quot;pm&quot;</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">pmra</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">pmdec</span>

    <span class="n">out</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">overplot</span><span class="p">:</span>
        <span class="n">cluster</span><span class="o">.</span><span class="n">to_units</span><span class="p">(</span><span class="n">units0</span><span class="p">)</span>
        <span class="n">cluster</span><span class="o">.</span><span class="n">to_origin</span><span class="p">(</span><span class="n">origin0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">do_centre</span><span class="p">:</span>
            <span class="n">xgc</span><span class="p">,</span> <span class="n">ygc</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">ragc</span><span class="p">,</span> <span class="n">cluster</span><span class="o">.</span><span class="n">decgc</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xgc</span><span class="p">,</span> <span class="n">ygc</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;COM&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">cluster</span><span class="o">.</span><span class="n">to_units</span><span class="p">(</span><span class="n">units0</span><span class="p">)</span>
        <span class="n">cluster</span><span class="o">.</span><span class="n">to_origin</span><span class="p">(</span><span class="n">origin0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">coords</span> <span class="o">==</span> <span class="s2">&quot;radec&quot;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Ra (degree)&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Dec (degree)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">coords</span> <span class="o">==</span> <span class="s2">&quot;pm&quot;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mu_</span><span class="si">{Ra}</span><span class="s2">$ (mas $yr^{-1}$)&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mu_</span><span class="si">{Dec}</span><span class="s2">$ (mas $yr^{-1}$)&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Time = </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cluster</span><span class="o">.</span><span class="n">tphys</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xlim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ylim</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">clustertools 0.1.dev1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Jeremy J. Webb.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>