
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>clustertools.analysis.cluster &#8212; clustertools 0.1.dev1 documentation</title>
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">clustertools 0.1.dev1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for clustertools.analysis.cluster</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot; The StarCluster class and key internal functions</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Jeremy J Webb&quot;</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;StarCluster&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sub_cluster&quot;</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">galpy.util</span> <span class="kn">import</span> <span class="n">_rotate_to_arbitrary_vector</span><span class="p">,</span> <span class="n">bovy_conversion</span><span class="p">,</span> <span class="n">bovy_coords</span>
<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">dedent</span>
<span class="kn">from</span> <span class="nn">galpy.potential</span> <span class="kn">import</span> <span class="n">MWPotential2014</span>
<span class="kn">from</span> <span class="nn">.orbit</span> <span class="kn">import</span> <span class="n">rtidal</span><span class="p">,</span> <span class="n">rlimiting</span><span class="p">,</span> <span class="n">initialize_orbit</span><span class="p">,</span> <span class="n">calc_actions</span>
<span class="kn">from</span> <span class="nn">.functions</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.profiles</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.operations</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>

<div class="viewcode-block" id="StarCluster"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster">[docs]</a><span class="k">class</span> <span class="nc">StarCluster</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME:</span>

<span class="sd">    __init__</span>

<span class="sd">    PURPOSE:</span>

<span class="sd">    A class that represents a star cluster population that functions can be performed on</span>

<span class="sd">    INPUT:</span>
<span class="sd">    tphys -Time (units not necessary) associated with the population (default: 0)</span>
<span class="sd">    units - Units of stellar positions and velocties. Options include &#39;pckms&#39;,</span>
<span class="sd">    &#39;kpckms&#39;,&#39;radec&#39;,&#39;nbody&#39;,and &#39;galpy&#39;. For &#39;pckms&#39; and &#39;kpckms&#39;, </span>
<span class="sd">    stellar velocities are assumed to be km/s. (default: None)</span>
<span class="sd">    origin - Origin of coordinate system within which stellar positions and velocities are defined. </span>
<span class="sd">    Options include &#39;centre&#39;, &#39;cluster&#39;, &#39;galaxy&#39; and &#39;sky&#39;. Note that &#39;centre&#39; corresponds</span>
<span class="sd">    to the systems centre of density or mass (as calculated by clustertools) while &#39;cluster&#39; corresponds</span>
<span class="sd">    to the orbital position of the cluster&#39;s initial centre of mass given &#39;tphys&#39;. In some cases</span>
<span class="sd">    these two coordinate systems may be the same. (default: None)</span>
<span class="sd">    ctype - Code type used to generate the cluster population. Current options include &#39;snapshot&#39;,</span>
<span class="sd">    &#39;nbody6&#39;,&#39;nbody6se&#39;,&#39;gyrfalcon&#39;,&#39;snaptrim&#39;, amuse&#39;,&#39;clustertools&#39;,&#39;snapauto&#39;. The parameter</span>
<span class="sd">    informs clustertools how to load the stellar popuation and advance to the next snapshot.</span>
<span class="sd">    (default: &#39;snapshot&#39;)</span>

<span class="sd">    **kwargs</span>

<span class="sd">    sfile - name of file containing single star data</span>
<span class="sd">    bfile - name of file contain binary star data</span>
<span class="sd">    ofilename - orbit filename if ofile is not given</span>
<span class="sd">    ounits - {&#39;pckms&#39;,&#39;kpckms&#39;,&#39;radec&#39;,&#39;nbody&#39;,&#39;galpy&#39;} units of orbital information (else assumed equal to StarCluster.units)</span>
<span class="sd">    nsnap - if a specific snapshot is to be read in instead of starting from zero</span>
<span class="sd">    nzfill - value for zfill when reading and writing snapshots (Default: 5)</span>
<span class="sd">    snapbase - string of characters in filename before nsnap (Default: &#39;&#39;)</span>
<span class="sd">    snapend - string of character in filename after nsnap (Default: &#39;.dat&#39;)</span>
<span class="sd">    snapdir - directory of snapshots if different than wdir (Default: &#39;&#39;)</span>
<span class="sd">    delimiter - choice of delimiter when reading ascii/csv files (Default: &#39;,&#39;)</span>
<span class="sd">    wdir - working directory of snapshots if not current directory</span>
<span class="sd">    intialize - initialize a galpy orbit after reading in orbital information (default: False)</span>
<span class="sd">    kwfile - open file containing stellar evolution type (kw) of individual stars (used if snapshot file does not contain kw and kw is needed)</span>
<span class="sd">    advance - set to True if this a snapshot that has been advanced to from an initial one?</span>
<span class="sd">    projected - calculate projected values as well as 3D values (Default: True)</span>
<span class="sd">    centre_method - {None,&#39;orthographic&#39;,&#39;VandeVen&#39;} method to convert to clustercentric coordinates when units are in degrees (Default: None)</span>

<span class="sd">    OUTPUT:</span>

<span class="sd">    StarCluster</span>

<span class="sd">    HISTORY:</span>

<span class="sd">    History - 2018 - Written - Webb (UofT)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ntot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tphys</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctype</span><span class="o">=</span><span class="s2">&quot;snapshot&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>

        <span class="c1"># Total Number of Stars + Binaries in the cluster</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ntot</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nb</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Age of cluster</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tphys</span> <span class="o">=</span> <span class="n">tphys</span>

        <span class="c1"># Cluster Simulation Type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctype</span> <span class="o">=</span> <span class="n">ctype</span>

        <span class="c1"># Kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nsnap</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nsnap&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;delimiter&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wdir</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;wdir&quot;</span><span class="p">,</span> <span class="s2">&quot;./&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nzfill</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nzfill&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">snapbase</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;snapbase&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">snapend</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;snapend&quot;</span><span class="p">,</span> <span class="s2">&quot;.dat&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">snapdir</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;snapdir&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skiprows</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;skiprows&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sfile</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sfile&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bfile</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bfile&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projected</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;projected&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">centre_method</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;centre_method&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># Initial arrays</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">zmbar</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rbar</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vstar</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tstar</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yc</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zc</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vxc</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vyc</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vzc</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xgc</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ygc</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zgc</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vxgc</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vygc</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vzgc</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">if</span> <span class="n">ctype</span> <span class="o">==</span> <span class="s2">&quot;observations&quot;</span> <span class="ow">or</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;radec&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ra</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pmra</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pmdec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vlos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ra_gc</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dec_gc</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dist_gc</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pmra_gc</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pmdec_gc</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vlos_gc</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">orbit</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># SE Arrays</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ospin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>

        <span class="c1"># BSE Array</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kw1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kw2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kcm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ecc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">semi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logl1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logl2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ep1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ep2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ospin1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ospin2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>

        <span class="c1"># Energies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">etot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([])</span>

        <span class="c1"># Lagrange Radii,limiting radius, tidal radius, and virial radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rn</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r10</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rl</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rt</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rv</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rorder</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rproorder</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Additional Parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trh</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dalpha</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eta</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="n">origin</span>

<div class="viewcode-block" id="StarCluster.add_stars"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.add_stars">[docs]</a>    <span class="k">def</span> <span class="nf">add_stars</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        NAME:</span>

<span class="sd">           add_stars</span>

<span class="sd">        PURPOSE:</span>

<span class="sd">           Add stars to the StarCluster instance</span>

<span class="sd">        INPUT:</span>

<span class="sd">           id - star id</span>

<span class="sd">           m - mass</span>

<span class="sd">           x,y,z - positions</span>

<span class="sd">           vx,vy,vz - velocities</span>

<span class="sd">           kw - stellar evolution tag (optional,for using with NBODY6) (default:0)</span>

<span class="sd">           do_key_params - call key_params() after adding stars (default: False)</span>

<span class="sd">            do_key_params - order stars by radius when calling key_params() (default: False)</span>

<span class="sd">        NOTES:</span>
<span class="sd">         if self.units==radec, input is assumed to be ra,dec,dist,pmra,pmdec,vlos with units </span>
<span class="sd">         of (degrees, degrees, kpc, mas/yr, mas/yr km/s)</span>

<span class="sd">        OUTPUT:</span>

<span class="sd">           None</span>

<span class="sd">        HISTORY:</span>

<span class="sd">           2018 - Written - Webb (UofT)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vx</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vx</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vy</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vy</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vz</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="nb">float</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ntot</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ntot</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">id</span><span class="p">))</span>

        <span class="c1"># Check lengths:</span>
        <span class="n">nmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vx</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vy</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vz</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">nmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vx</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vy</span><span class="p">),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vz</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">nmax</span> <span class="o">!=</span> <span class="n">nmin</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ntot</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ntot</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nmax</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nmax</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nmax</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nmax</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nmax</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">vx</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vy</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nmax</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">vy</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vz</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nmax</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">vz</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;radec&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">==</span> <span class="s2">&quot;sky&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ra</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dec</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pmra</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vx</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pmdec</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vy</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vlos</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vz</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kw</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rv3d</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">do_key_params</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key_params</span><span class="p">(</span><span class="n">do_order</span><span class="o">=</span><span class="n">do_order</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ntot</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Added </span><span class="si">%i</span><span class="s2"> stars to StarCluster&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ntot</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ntot</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.add_orbit"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.add_orbit">[docs]</a>    <span class="k">def</span> <span class="nf">add_orbit</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">xgc</span><span class="p">,</span>
        <span class="n">ygc</span><span class="p">,</span>
        <span class="n">zgc</span><span class="p">,</span>
        <span class="n">vxgc</span><span class="p">,</span>
        <span class="n">vygc</span><span class="p">,</span>
        <span class="n">vzgc</span><span class="p">,</span>
        <span class="n">ounits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">initialize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">ro</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span>
        <span class="n">vo</span><span class="o">=</span><span class="mf">220.0</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        NAME:</span>

<span class="sd">           add_orbit</span>

<span class="sd">        PURPOSE:</span>

<span class="sd">           Add orbital information of the star cluster</span>
<span class="sd">           Notes:</span>
<span class="sd">            - the input units are assumed to be equal that of self.units</span>

<span class="sd">        INPUT:</span>

<span class="sd">           xgc,ygc,zgc - cluster&#39;s galactocentric position</span>

<span class="sd">           vxgc,vygc,vzgc - cluster&#39;s galactocentric velocity</span>

<span class="sd">        OUTPUT:</span>

<span class="sd">           None</span>

<span class="sd">        HISTORY:</span>

<span class="sd">           2018 - Written - Webb (UofT)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ounits</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ounits</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">:</span>
            <span class="c1"># First convert to kpckms</span>
            <span class="k">if</span> <span class="n">ounits</span> <span class="o">!=</span> <span class="s2">&quot;kpckms&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ounits</span> <span class="o">==</span> <span class="s2">&quot;nbody&quot;</span><span class="p">:</span>
                    <span class="n">xgc</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rbar</span> <span class="o">*</span> <span class="mf">1000.0</span>
                    <span class="n">ygc</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rbar</span> <span class="o">*</span> <span class="mf">1000.0</span>
                    <span class="n">zgc</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rbar</span> <span class="o">*</span> <span class="mf">1000.0</span>
                    <span class="n">vxgc</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vstar</span>
                    <span class="n">vygc</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vstar</span>
                    <span class="n">vzgc</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vstar</span>
                <span class="k">elif</span> <span class="n">ounits</span> <span class="o">==</span> <span class="s2">&quot;galpy&quot;</span><span class="p">:</span>
                    <span class="n">xgc</span> <span class="o">*=</span> <span class="n">ro</span>
                    <span class="n">ygc</span> <span class="o">*=</span> <span class="n">ro</span>
                    <span class="n">zgc</span> <span class="o">*=</span> <span class="n">ro</span>
                    <span class="n">vxgc</span> <span class="o">*=</span> <span class="n">vo</span>
                    <span class="n">vygc</span> <span class="o">*=</span> <span class="n">vo</span>
                    <span class="n">vzgc</span> <span class="o">*=</span> <span class="n">vo</span>
                <span class="k">elif</span> <span class="n">ounits</span> <span class="o">==</span> <span class="s2">&quot;pckms&quot;</span><span class="p">:</span>
                    <span class="n">xgc</span> <span class="o">/=</span> <span class="mf">1000.0</span>
                    <span class="n">ygc</span> <span class="o">/=</span> <span class="mf">1000.0</span>
                    <span class="n">zgc</span> <span class="o">/=</span> <span class="mf">1000.0</span>

                <span class="n">ounits</span> <span class="o">=</span> <span class="s2">&quot;kpckms&quot;</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;pckms&quot;</span><span class="p">:</span>
                <span class="n">xgc</span> <span class="o">*=</span> <span class="mf">1000.0</span>
                <span class="n">ygc</span> <span class="o">*=</span> <span class="mf">1000.0</span>
                <span class="n">zgc</span> <span class="o">*=</span> <span class="mf">1000.0</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;nbody&quot;</span><span class="p">:</span>
                <span class="n">xgc</span> <span class="o">*=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rbar</span>
                <span class="n">ygc</span> <span class="o">*=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rbar</span>
                <span class="n">zgc</span> <span class="o">*=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rbar</span>
                <span class="n">vxgc</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vstar</span>
                <span class="n">vygc</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vstar</span>
                <span class="n">vzgc</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vstar</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;galpy&quot;</span><span class="p">:</span>
                <span class="n">xgc</span> <span class="o">/=</span> <span class="n">ro</span>
                <span class="n">ygc</span> <span class="o">/=</span> <span class="n">ro</span>
                <span class="n">zgc</span> <span class="o">/=</span> <span class="n">ro</span>
                <span class="n">vxgc</span> <span class="o">/=</span> <span class="n">vo</span>
                <span class="n">vygc</span> <span class="o">/=</span> <span class="n">vo</span>
                <span class="n">vzgc</span> <span class="o">/=</span> <span class="n">vo</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xgc</span> <span class="o">=</span> <span class="n">xgc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ygc</span> <span class="o">=</span> <span class="n">ygc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zgc</span> <span class="o">=</span> <span class="n">zgc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rgc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xgc</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="n">ygc</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="n">zgc</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vxgc</span> <span class="o">=</span> <span class="n">vxgc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vygc</span> <span class="o">=</span> <span class="n">vygc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vzgc</span> <span class="o">=</span> <span class="n">vzgc</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;radec&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ra_gc</span> <span class="o">=</span> <span class="n">xgc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dec_gc</span> <span class="o">=</span> <span class="n">ygc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dist_gc</span> <span class="o">=</span> <span class="n">zgc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pmra_gc</span> <span class="o">=</span> <span class="n">vxgc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pmdec_gc</span> <span class="o">=</span> <span class="n">vygc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vlos_gc</span> <span class="o">=</span> <span class="n">vzgc</span>

        <span class="k">if</span> <span class="n">initialize</span><span class="p">:</span>
            <span class="n">initialize_orbit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_centre</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.add_nbody6"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.add_nbody6">[docs]</a>    <span class="k">def</span> <span class="nf">add_nbody6</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">rc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">rbar</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">rtide</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">xc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">yc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">zc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">zmbar</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">vstar</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">rscale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">ns</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">nb</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">np</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        NAME:</span>

<span class="sd">           add_nbody6</span>

<span class="sd">        PURPOSE:</span>

<span class="sd">           For data generated using NBDOY6 (or one of its variants), add additional information from output files</span>

<span class="sd">        INPUT:</span>

<span class="sd">           nc - number of stars in core (default:0)</span>

<span class="sd">           rc - core radius (default:0)</span>

<span class="sd">           rbar - scaling factor between NBODY units and pc (default:1.)</span>

<span class="sd">           rtide - rtide set in the simulation (default:0)</span>

<span class="sd">           xc,yc,zc - position of cluster centre (default:0)</span>

<span class="sd">           zmbar - scaling factor between NBODY units and Msun (default:1.)</span>

<span class="sd">           vstar - scaling factor between NBODY units and km/s (default:1.)</span>

<span class="sd">           rscale - the scale radius of data (default:1.)</span>

<span class="sd">           ns - number of single stars (default:0)</span>

<span class="sd">           nb - number of binary stars (default:0)</span>

<span class="sd">           np - number of particles (default:0)</span>

<span class="sd">        OUTPUT:</span>

<span class="sd">           None</span>

<span class="sd">        HISTORY:</span>

<span class="sd">           2018 - Written - Webb (UofT)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Number of stars in the core</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nc</span> <span class="o">=</span> <span class="n">nc</span>
        <span class="c1"># Core radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rc</span> <span class="o">=</span> <span class="n">rc</span>
        <span class="c1"># Distane scaling parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rbar</span> <span class="o">=</span> <span class="n">rbar</span>
        <span class="c1"># Tidal limit from NBODY6 (not neccesarily a true tidal radius)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rtide</span> <span class="o">=</span> <span class="n">rtide</span>
        <span class="c1"># Center of mass of cluster (x,yz)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="n">xc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yc</span> <span class="o">=</span> <span class="n">yc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zc</span> <span class="o">=</span> <span class="n">zc</span>
        <span class="c1"># Mass scaling parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zmbar</span> <span class="o">=</span> <span class="n">zmbar</span>
        <span class="c1"># Velocity scaling parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vstar</span> <span class="o">=</span> <span class="n">vstar</span>
        <span class="c1"># Scale radius of cluster</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rscale</span> <span class="o">=</span> <span class="n">rscale</span>
        <span class="c1"># Number of single stars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ns</span> <span class="o">=</span> <span class="n">ns</span>
        <span class="c1"># Number of binary stars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nb</span> <span class="o">=</span> <span class="n">nb</span>
        <span class="c1"># Number of particles (from NBODY6 when tidal tail is being integrated)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">np</span> <span class="o">=</span> <span class="n">np</span></div>

<div class="viewcode-block" id="StarCluster.add_sse"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.add_sse">[docs]</a>    <span class="k">def</span> <span class="nf">add_sse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kw</span><span class="p">,</span> <span class="n">logl</span><span class="p">,</span> <span class="n">logr</span><span class="p">,</span> <span class="n">ep</span><span class="p">,</span> <span class="n">ospin</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        NAME:</span>

<span class="sd">           add_sse</span>

<span class="sd">        PURPOSE:</span>

<span class="sd">           Add stellar evolution information to stars</span>
<span class="sd">           Notes:</span>
<span class="sd">            - parameters are common output variables in NBODY6</span>
<span class="sd">            - values are never adjusted during unit or coordinate changes</span>

<span class="sd">        INPUT:</span>

<span class="sd">           kw - stellar evolution tag (for using with NBODY6) </span>

<span class="sd">           logl - log of luminosity</span>

<span class="sd">           logr - log of stellar radius</span>

<span class="sd">           ep - epoch</span>

<span class="sd">           ospin - ospin</span>

<span class="sd">        OUTPUT:</span>

<span class="sd">           None</span>

<span class="sd">        HISTORY:</span>

<span class="sd">           2018 - Written - Webb (UofT)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">logl</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">logr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lum</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">logl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ltot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ep</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ospin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ospin</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.add_bse"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.add_bse">[docs]</a>    <span class="k">def</span> <span class="nf">add_bse</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">id1</span><span class="p">,</span>
        <span class="n">id2</span><span class="p">,</span>
        <span class="n">kw1</span><span class="p">,</span>
        <span class="n">kw2</span><span class="p">,</span>
        <span class="n">kcm</span><span class="p">,</span>
        <span class="n">ecc</span><span class="p">,</span>
        <span class="n">pb</span><span class="p">,</span>
        <span class="n">semi</span><span class="p">,</span>
        <span class="n">m1</span><span class="p">,</span>
        <span class="n">m2</span><span class="p">,</span>
        <span class="n">logl1</span><span class="p">,</span>
        <span class="n">logl2</span><span class="p">,</span>
        <span class="n">logr1</span><span class="p">,</span>
        <span class="n">logr2</span><span class="p">,</span>
        <span class="n">ep1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ep2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ospin1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ospin2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        NAME:</span>

<span class="sd">        add_bse</span>

<span class="sd">        PURPOSE:</span>

<span class="sd">        Add binary star evolution information to stars</span>
<span class="sd">        Notes:</span>
<span class="sd">        - parameters are common output variables in NBODY6</span>
<span class="sd">        - values are never adjusted during unit or coordinate changes</span>

<span class="sd">        INPUT:</span>

<span class="sd">        id1/id2 - id of star1 and star2</span>

<span class="sd">        kw1/kw2 - stellar evolution tags (for using with NBODY6) </span>

<span class="sd">        kcm - stellar evolution tag for binary star</span>

<span class="sd">        ecc - eccentricity of binary orbit</span>

<span class="sd">        pb - period of binary orbit</span>

<span class="sd">        semi - semi major axis of binary orbit</span>

<span class="sd">        m1/m2 - masses of binary stars</span>

<span class="sd">        logl1/logl2 - luminosities of binary stars</span>

<span class="sd">        logr1/logr2 - radii of binary stars</span>

<span class="sd">        ep1/ep2 - epochs of binary stars</span>

<span class="sd">        ospin1/ospin2 - opsin of binary stars</span>

<span class="sd">        OUTPUT:</span>

<span class="sd">        None</span>

<span class="sd">        HISTORY:</span>

<span class="sd">        2018 - Written - Webb (UofT)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">id1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">id2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kw1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">kw1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kw2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">kw2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kcm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">kcm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ecc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ecc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">semi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">semi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">m2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logl1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">logl1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logl2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">logl2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">logr1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">logr2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ep1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ep1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ep1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ep2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ep2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ospin1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ospin1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ospin2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ospin2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eb</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">m1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">m2</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">semi</span></div>

<div class="viewcode-block" id="StarCluster.add_energies"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.add_energies">[docs]</a>    <span class="k">def</span> <span class="nf">add_energies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kin</span><span class="p">,</span> <span class="n">pot</span><span class="p">,</span> <span class="n">etot</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        NAME:</span>

<span class="sd">           add_energies</span>

<span class="sd">        PURPOSE:</span>

<span class="sd">           Add energy information to stars and calculate total energy and Q for the cluster</span>
<span class="sd">           Notes:</span>
<span class="sd">            - values are never adjusted during unit or coordinate changes</span>

<span class="sd">        INPUT:</span>

<span class="sd">           kin - kinetic energy </span>

<span class="sd">           pot - potentail energy</span>

<span class="sd">           etot - total energy</span>

<span class="sd">        OUTPUT:</span>

<span class="sd">           None</span>

<span class="sd">        HISTORY:</span>

<span class="sd">           2018 - Written - Webb (UofT)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">kin</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">etot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">etot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ektot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kin</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pot</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptot</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qvir</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qvir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ektot</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptot</span></div>

<div class="viewcode-block" id="StarCluster.add_actions"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.add_actions">[docs]</a>    <span class="k">def</span> <span class="nf">add_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">JR</span><span class="p">,</span> <span class="n">Jphi</span><span class="p">,</span> <span class="n">Jz</span><span class="p">,</span> <span class="n">OR</span><span class="p">,</span> <span class="n">Ophi</span><span class="p">,</span> <span class="n">Oz</span><span class="p">,</span> <span class="n">TR</span><span class="p">,</span> <span class="n">Tphi</span><span class="p">,</span> <span class="n">Tz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        NAME:</span>

<span class="sd">           add_actions</span>

<span class="sd">        PURPOSE:</span>

<span class="sd">           Add action angle values to the cluster instance</span>

<span class="sd">        INPUT:</span>

<span class="sd">           JR,Jphi,Jz,OR,Ophi,Oz,TR,Tphi,Tz</span>

<span class="sd">        OUTPUT:</span>

<span class="sd">            None</span>

<span class="sd">        HISTORY:</span>

<span class="sd">           2019 - Written - Webb (UofT)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">JR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Jphi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Jz</span> <span class="o">=</span> <span class="n">JR</span><span class="p">,</span> <span class="n">Jphi</span><span class="p">,</span> <span class="n">Jz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ophi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Oz</span> <span class="o">=</span> <span class="n">OR</span><span class="p">,</span> <span class="n">Ophi</span><span class="p">,</span> <span class="n">Oz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tphi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tz</span> <span class="o">=</span> <span class="n">TR</span><span class="p">,</span> <span class="n">Tphi</span><span class="p">,</span> <span class="n">Tz</span></div>

<div class="viewcode-block" id="StarCluster.rv3d"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.rv3d">[docs]</a>    <span class="k">def</span> <span class="nf">rv3d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;radec&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rpro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vx</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vy</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vpro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rpro</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vx</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vy</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vz</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vpro</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vx</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vy</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.key_params"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.key_params">[docs]</a>    <span class="k">def</span> <span class="nf">key_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        NAME:</span>

<span class="sd">           key_params</span>

<span class="sd">        PURPOSE:</span>

<span class="sd">           Find key parameters of the cluster (mass,luminosity,r10,r50,rh10,rh50)</span>

<span class="sd">        INPUT:</span>

<span class="sd">           do_order - Perform the time consuming task of ordering stars based on radius to find r10,r50, etc. (default:False)</span>

<span class="sd">        OUTPUT:</span>

<span class="sd">            None</span>

<span class="sd">        HISTORY:</span>

<span class="sd">           2018 - Written - Webb (UofT)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mtot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mmean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>

        <span class="c1"># Radially order the stars to find half-mass radius</span>
        <span class="k">if</span> <span class="n">do_order</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rorder</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">projected</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rproorder</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rpro</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rorder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">msum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rorder</span><span class="p">])</span>
            <span class="n">indx</span> <span class="o">=</span> <span class="n">msum</span> <span class="o">&gt;=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mtot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rorder</span><span class="p">[</span><span class="n">indx</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>  
            <span class="n">indx</span> <span class="o">=</span> <span class="n">msum</span> <span class="o">&gt;=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mtot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">r10</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rorder</span><span class="p">[</span><span class="n">indx</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">projected</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">rproorder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">msum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rproorder</span><span class="p">])</span>
            <span class="n">indx</span> <span class="o">=</span> <span class="n">msum</span> <span class="o">&gt;=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mtot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rmpro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpro</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rproorder</span><span class="p">[</span><span class="n">indx</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">indx</span> <span class="o">=</span> <span class="n">msum</span> <span class="o">&gt;=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mtot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">r10pro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpro</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rproorder</span><span class="p">[</span><span class="n">indx</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rmpro</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">r10pro</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">rorder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lum</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rorder</span><span class="p">])</span>
            <span class="n">indx</span> <span class="o">=</span> <span class="n">lsum</span> <span class="o">&gt;=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ltot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rorder</span><span class="p">[</span><span class="n">indx</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">indx</span> <span class="o">=</span> <span class="n">lsum</span> <span class="o">&gt;=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ltot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rh10</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rorder</span><span class="p">[</span><span class="n">indx</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">projected</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">rproorder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lum</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rproorder</span><span class="p">])</span>
                <span class="n">indx</span> <span class="o">=</span> <span class="n">lsum</span> <span class="o">&gt;=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ltot</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rhpro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpro</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rproorder</span><span class="p">[</span><span class="n">indx</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">indx</span> <span class="o">=</span> <span class="n">lsum</span> <span class="o">&gt;=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ltot</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rh10pro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpro</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rproorder</span><span class="p">[</span><span class="n">indx</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rhpro</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rh10pro</span> <span class="o">=</span> <span class="mf">0.0</span></div>

    <span class="c1"># Directly call from operations.py (see operations.py files for documenation):</span>

<div class="viewcode-block" id="StarCluster.find_centre"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.find_centre">[docs]</a>    <span class="k">def</span> <span class="nf">find_centre</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">xstart</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">ystart</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">zstart</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">vxstart</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">vystart</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">vzstart</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">indx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">nsigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">nsphere</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">rmin</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="n">nmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">ro</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span>
        <span class="n">vo</span><span class="o">=</span><span class="mf">220.0</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zc</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">vxc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vyc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vzc</span><span class="o">=</span><span class="n">find_centre</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xstart</span><span class="o">=</span><span class="n">xstart</span><span class="p">,</span>
            <span class="n">ystart</span><span class="o">=</span><span class="n">ystart</span><span class="p">,</span><span class="n">zstart</span><span class="o">=</span><span class="n">zstart</span><span class="p">,</span><span class="n">vxstart</span><span class="o">=</span><span class="n">vxstart</span><span class="p">,</span><span class="n">vystart</span><span class="o">=</span><span class="n">vystart</span><span class="p">,</span><span class="n">vzstart</span><span class="o">=</span><span class="n">vzstart</span><span class="p">,</span><span class="n">indx</span><span class="o">=</span><span class="n">indx</span><span class="p">,</span>
            <span class="n">nsigma</span><span class="o">=</span><span class="n">nsigma</span><span class="p">,</span><span class="n">nsphere</span><span class="o">=</span><span class="n">nsphere</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="n">density</span><span class="p">,</span>
            <span class="n">rmin</span><span class="o">=</span><span class="n">rmin</span><span class="p">,</span><span class="n">nmax</span><span class="o">=</span><span class="n">nmax</span><span class="p">,</span><span class="n">ro</span><span class="o">=</span><span class="n">ro</span><span class="p">,</span><span class="n">vo</span><span class="o">=</span><span class="n">vo</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">==</span> <span class="s2">&quot;galaxy&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin</span><span class="o">==</span><span class="s1">&#39;sky&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xgc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ygc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zgc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vxgc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vygc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vzgc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vxc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vyc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vzc</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zc</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vxc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vyc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vzc</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>      </div>

<div class="viewcode-block" id="StarCluster.find_centre_of_density"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.find_centre_of_density">[docs]</a>    <span class="k">def</span> <span class="nf">find_centre_of_density</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">xstart</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">ystart</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">zstart</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">vxstart</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">vystart</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">vzstart</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">indx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">rmin</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="n">nmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">ro</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span>
        <span class="n">vo</span><span class="o">=</span><span class="mf">220.0</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zc</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">vxc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vyc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vzc</span><span class="o">=</span><span class="n">find_centre_of_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xstart</span><span class="o">=</span><span class="n">xstart</span><span class="p">,</span>
            <span class="n">ystart</span><span class="o">=</span><span class="n">ystart</span><span class="p">,</span><span class="n">zstart</span><span class="o">=</span><span class="n">zstart</span><span class="p">,</span><span class="n">vxstart</span><span class="o">=</span><span class="n">vxstart</span><span class="p">,</span><span class="n">vystart</span><span class="o">=</span><span class="n">vystart</span><span class="p">,</span><span class="n">vzstart</span><span class="o">=</span><span class="n">vzstart</span><span class="p">,</span><span class="n">indx</span><span class="o">=</span><span class="n">indx</span><span class="p">,</span>
            <span class="n">rmin</span><span class="o">=</span><span class="n">rmin</span><span class="p">,</span><span class="n">nmax</span><span class="o">=</span><span class="n">nmax</span><span class="p">,</span><span class="n">ro</span><span class="o">=</span><span class="n">ro</span><span class="p">,</span><span class="n">vo</span><span class="o">=</span><span class="n">vo</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.find_centre_of_mass"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.find_centre_of_mass">[docs]</a>    <span class="k">def</span> <span class="nf">find_centre_of_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zc</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">vxc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vyc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vzc</span><span class="o">=</span><span class="n">find_centre_of_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.to_pckms"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.to_pckms">[docs]</a>    <span class="k">def</span> <span class="nf">to_pckms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">to_pckms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">do_key_params</span><span class="o">=</span><span class="n">do_key_params</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.to_kpckms"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.to_kpckms">[docs]</a>    <span class="k">def</span> <span class="nf">to_kpckms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">vo</span><span class="o">=</span><span class="mf">220.0</span><span class="p">):</span>
        <span class="n">to_kpckms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">do_key_params</span><span class="o">=</span><span class="n">do_key_params</span><span class="p">,</span><span class="n">ro</span><span class="o">=</span><span class="n">ro</span><span class="p">,</span><span class="n">vo</span><span class="o">=</span><span class="n">vo</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.to_nbody"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.to_nbody">[docs]</a>    <span class="k">def</span> <span class="nf">to_nbody</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">vo</span><span class="o">=</span><span class="mf">220.0</span><span class="p">):</span>
        <span class="n">to_nbody</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="n">do_key_params</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="n">ro</span><span class="p">,</span> <span class="n">vo</span><span class="o">=</span><span class="n">vo</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.to_radec"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.to_radec">[docs]</a>    <span class="k">def</span> <span class="nf">to_radec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">vo</span><span class="o">=</span><span class="mf">220.0</span><span class="p">):</span>
        <span class="n">to_radec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="n">do_key_params</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="n">ro</span><span class="p">,</span> <span class="n">vo</span><span class="o">=</span><span class="n">vo</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.from_radec"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.from_radec">[docs]</a>    <span class="k">def</span> <span class="nf">from_radec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">from_radec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="n">do_order</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="n">do_key_params</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.to_galpy"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.to_galpy">[docs]</a>    <span class="k">def</span> <span class="nf">to_galpy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">vo</span><span class="o">=</span><span class="mf">220.0</span><span class="p">):</span>
        <span class="n">to_galpy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="n">do_key_params</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="n">ro</span><span class="p">,</span> <span class="n">vo</span><span class="o">=</span><span class="n">vo</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.to_units"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.to_units">[docs]</a>    <span class="k">def</span> <span class="nf">to_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">vo</span><span class="o">=</span><span class="mf">220.0</span><span class="p">):</span>
        <span class="n">to_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="n">do_order</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="n">do_key_params</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="n">ro</span><span class="p">,</span> <span class="n">vo</span><span class="o">=</span><span class="n">vo</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.convert_binary_units"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.convert_binary_units">[docs]</a>    <span class="k">def</span> <span class="nf">convert_binary_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param</span><span class="p">,</span><span class="n">from_units</span><span class="p">,</span><span class="n">to_units</span><span class="p">):</span>
        <span class="n">convert_binary_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param</span><span class="p">,</span><span class="n">from_units</span><span class="p">,</span><span class="n">to_units</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.to_centre"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.to_centre">[docs]</a>    <span class="k">def</span> <span class="nf">to_centre</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">centre_method</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">to_centre</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="n">do_order</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="n">do_key_params</span><span class="p">,</span> <span class="n">centre_method</span><span class="o">=</span><span class="n">centre_method</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.to_cluster"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.to_cluster">[docs]</a>    <span class="k">def</span> <span class="nf">to_cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">centre_method</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">to_cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="n">do_order</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="n">do_key_params</span><span class="p">,</span> <span class="n">centre_method</span><span class="o">=</span><span class="n">centre_method</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.to_galaxy"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.to_galaxy">[docs]</a>    <span class="k">def</span> <span class="nf">to_galaxy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">to_galaxy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="n">do_order</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="n">do_key_params</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.to_sky"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.to_sky">[docs]</a>    <span class="k">def</span> <span class="nf">to_sky</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">to_sky</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="n">do_order</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="n">do_key_params</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.from_sky"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.from_sky">[docs]</a>    <span class="k">def</span> <span class="nf">from_sky</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">from_sky</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="n">do_order</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="n">do_key_params</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.to_tail"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.to_tail">[docs]</a>    <span class="k">def</span> <span class="nf">to_tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_tail</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">y_tail</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">z_tail</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">vx_tail</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">vy_tail</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">vz_tail</span><span class="o">=</span><span class="n">to_tail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_tail</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_tail</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_tail</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_tail</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_tail</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vx_tail</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vy_tail</span> <span class="o">**</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vz_tail</span> <span class="o">**</span> <span class="mf">2.0</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.to_origin"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.to_origin">[docs]</a>    <span class="k">def</span> <span class="nf">to_origin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">to_origin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">do_order</span><span class="o">=</span><span class="n">do_order</span><span class="p">,</span> <span class="n">do_key_params</span><span class="o">=</span><span class="n">do_key_params</span><span class="p">)</span></div>

    <span class="c1"># Directly call from functions.py (see functions.py files for documenation):</span>

<div class="viewcode-block" id="StarCluster.energies"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.energies">[docs]</a>    <span class="k">def</span> <span class="nf">energies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specific</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">i_d</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">ek</span><span class="p">,</span> <span class="n">pot</span><span class="p">,</span> <span class="n">etot</span> <span class="o">=</span> <span class="n">energies</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">specific</span><span class="o">=</span><span class="n">specific</span><span class="p">,</span> <span class="n">i_d</span><span class="o">=</span><span class="n">i_d</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="n">full</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="n">parallel</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_energies</span><span class="p">(</span><span class="n">ek</span><span class="p">,</span> <span class="n">pot</span><span class="p">,</span> <span class="n">etot</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.rlagrange"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.rlagrange">[docs]</a>    <span class="k">def</span> <span class="nf">rlagrange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nlagrange</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">projected</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rn</span> <span class="o">=</span> <span class="n">rlagrange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nlagrange</span><span class="o">=</span><span class="n">nlagrange</span><span class="p">,</span> <span class="n">projected</span><span class="o">=</span><span class="n">projected</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.rvirial"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.rvirial">[docs]</a>    <span class="k">def</span> <span class="nf">rvirial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">H</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">Om</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">overdens</span><span class="o">=</span><span class="mf">200.0</span><span class="p">,</span> <span class="n">nrad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">projected</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rv</span> <span class="o">=</span> <span class="n">rvirial</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">H</span><span class="o">=</span><span class="n">H</span><span class="p">,</span> <span class="n">Om</span><span class="o">=</span><span class="n">Om</span><span class="p">,</span> <span class="n">overdens</span><span class="o">=</span><span class="n">overdens</span><span class="p">,</span> <span class="n">nrad</span><span class="o">=</span><span class="n">nrad</span><span class="p">,</span> <span class="n">projected</span><span class="o">=</span><span class="n">projected</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.virial_radius"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.virial_radius">[docs]</a>    <span class="k">def</span> <span class="nf">virial_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">projected</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rv</span> <span class="o">=</span> <span class="n">virial_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">projected</span><span class="o">=</span><span class="n">projected</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.rtidal"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.rtidal">[docs]</a>    <span class="k">def</span> <span class="nf">rtidal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pot</span><span class="o">=</span><span class="n">MWPotential2014</span><span class="p">,</span> <span class="n">rtiterate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rgc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">vo</span><span class="o">=</span><span class="mf">220.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rt</span> <span class="o">=</span> <span class="n">rtidal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pot</span><span class="o">=</span><span class="n">pot</span><span class="p">,</span> <span class="n">rtiterate</span><span class="o">=</span><span class="n">rtiterate</span><span class="p">,</span> <span class="n">rgc</span><span class="o">=</span><span class="n">rgc</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="n">ro</span><span class="p">,</span> <span class="n">vo</span><span class="o">=</span><span class="n">vo</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.rlimiting"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.rlimiting">[docs]</a>    <span class="k">def</span> <span class="nf">rlimiting</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">pot</span><span class="o">=</span><span class="n">MWPotential2014</span><span class="p">,</span>
        <span class="n">rgc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ro</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span>
        <span class="n">vo</span><span class="o">=</span><span class="mf">220.0</span><span class="p">,</span>
        <span class="n">nrad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">projected</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rl</span> <span class="o">=</span> <span class="n">rlimiting</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">pot</span><span class="o">=</span><span class="n">pot</span><span class="p">,</span>
            <span class="n">rgc</span><span class="o">=</span><span class="n">rgc</span><span class="p">,</span>
            <span class="n">ro</span><span class="o">=</span><span class="n">ro</span><span class="p">,</span>
            <span class="n">vo</span><span class="o">=</span><span class="n">vo</span><span class="p">,</span>
            <span class="n">nrad</span><span class="o">=</span><span class="n">nrad</span><span class="p">,</span>
            <span class="n">projected</span><span class="o">=</span><span class="n">projected</span><span class="p">,</span>
            <span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.mass_function"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.mass_function">[docs]</a>    <span class="k">def</span> <span class="nf">mass_function</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">mmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">nmass</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">rmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">rmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">emin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">emax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">kwmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">kwmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">indx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">mcorr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">projected</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="n">m_mean</span><span class="p">,</span> <span class="n">m_hist</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">ealpha</span><span class="p">,</span> <span class="n">yalpha</span><span class="p">,</span> <span class="n">eyalpha</span> <span class="o">=</span> <span class="n">mass_function</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">mmin</span><span class="o">=</span><span class="n">mmin</span><span class="p">,</span>
            <span class="n">mmax</span><span class="o">=</span><span class="n">mmax</span><span class="p">,</span>
            <span class="n">nmass</span><span class="o">=</span><span class="n">nmass</span><span class="p">,</span>
            <span class="n">rmin</span><span class="o">=</span><span class="n">rmin</span><span class="p">,</span>
            <span class="n">rmax</span><span class="o">=</span><span class="n">rmax</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
            <span class="n">emin</span><span class="o">=</span><span class="n">emin</span><span class="p">,</span>
            <span class="n">emax</span><span class="o">=</span><span class="n">emax</span><span class="p">,</span>
            <span class="n">kwmin</span><span class="o">=</span><span class="n">kwmin</span><span class="p">,</span>
            <span class="n">kwmax</span><span class="o">=</span><span class="n">kwmax</span><span class="p">,</span>
            <span class="n">indx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">mcorr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">projected</span><span class="o">=</span><span class="n">projected</span><span class="p">,</span>
            <span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;GLOBAL&quot;</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rn</span> <span class="o">=</span> <span class="n">rlagrange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nlagrange</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">projected</span><span class="o">=</span><span class="n">projected</span><span class="p">)</span>
        <span class="n">m_mean</span><span class="p">,</span> <span class="n">m_hist</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">ealpha</span><span class="p">,</span> <span class="n">yalpha</span><span class="p">,</span> <span class="n">eyalpha</span> <span class="o">=</span> <span class="n">mass_function</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">mmin</span><span class="o">=</span><span class="n">mmin</span><span class="p">,</span>
            <span class="n">mmax</span><span class="o">=</span><span class="n">mmax</span><span class="p">,</span>
            <span class="n">nmass</span><span class="o">=</span><span class="n">nmass</span><span class="p">,</span>
            <span class="n">rmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rn</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
            <span class="n">rmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rn</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
            <span class="n">emin</span><span class="o">=</span><span class="n">emin</span><span class="p">,</span>
            <span class="n">emax</span><span class="o">=</span><span class="n">emax</span><span class="p">,</span>
            <span class="n">kwmin</span><span class="o">=</span><span class="n">kwmin</span><span class="p">,</span>
            <span class="n">kwmax</span><span class="o">=</span><span class="n">kwmax</span><span class="p">,</span>
            <span class="n">indx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">mcorr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">projected</span><span class="o">=</span><span class="n">projected</span><span class="p">,</span>
            <span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;AT R50&quot;</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha50</span> <span class="o">=</span> <span class="n">alpha</span></div>

<div class="viewcode-block" id="StarCluster.eta_function"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.eta_function">[docs]</a>    <span class="k">def</span> <span class="nf">eta_function</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">mmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">nmass</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">rmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">rmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">emin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">emax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">kwmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">kwmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">projected</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="n">m_mean</span><span class="p">,</span> <span class="n">sigvm</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">eeta</span><span class="p">,</span> <span class="n">yeta</span><span class="p">,</span> <span class="n">eyeta</span> <span class="o">=</span> <span class="n">eta_function</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">mmin</span><span class="o">=</span><span class="n">mmin</span><span class="p">,</span>
            <span class="n">mmax</span><span class="o">=</span><span class="n">mmax</span><span class="p">,</span>
            <span class="n">nmass</span><span class="o">=</span><span class="n">nmass</span><span class="p">,</span>
            <span class="n">rmin</span><span class="o">=</span><span class="n">rmin</span><span class="p">,</span>
            <span class="n">rmax</span><span class="o">=</span><span class="n">rmax</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
            <span class="n">emin</span><span class="o">=</span><span class="n">emin</span><span class="p">,</span>
            <span class="n">emax</span><span class="o">=</span><span class="n">emax</span><span class="p">,</span>
            <span class="n">kwmin</span><span class="o">=</span><span class="n">kwmin</span><span class="p">,</span>
            <span class="n">kwmax</span><span class="o">=</span><span class="n">kwmax</span><span class="p">,</span>
            <span class="n">projected</span><span class="o">=</span><span class="n">projected</span><span class="p">,</span>
            <span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eta</span> <span class="o">=</span> <span class="n">eta</span></div>

    <span class="c1"># Directly call from profiles.py (see profiles.py files for documenation):</span>

<div class="viewcode-block" id="StarCluster.alpha_prof"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.alpha_prof">[docs]</a>    <span class="k">def</span> <span class="nf">alpha_prof</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">mmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">nmass</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">rmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">rmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">nrad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">emin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">emax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">kwmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">kwmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">indx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">mcorr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">projected</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="n">lrprofn</span><span class="p">,</span> <span class="n">aprof</span><span class="p">,</span> <span class="n">dalpha</span><span class="p">,</span> <span class="n">edalpha</span><span class="p">,</span> <span class="n">ydalpha</span><span class="p">,</span> <span class="n">eydalpha</span> <span class="o">=</span> <span class="n">alpha_prof</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">mmin</span><span class="o">=</span><span class="n">mmin</span><span class="p">,</span>
            <span class="n">mmax</span><span class="o">=</span><span class="n">mmax</span><span class="p">,</span>
            <span class="n">nmass</span><span class="o">=</span><span class="n">nmass</span><span class="p">,</span>
            <span class="n">rmin</span><span class="o">=</span><span class="n">rmin</span><span class="p">,</span>
            <span class="n">rmax</span><span class="o">=</span><span class="n">rmax</span><span class="p">,</span>
            <span class="n">nrad</span><span class="o">=</span><span class="n">nrad</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
            <span class="n">emin</span><span class="o">=</span><span class="n">emin</span><span class="p">,</span>
            <span class="n">emax</span><span class="o">=</span><span class="n">emax</span><span class="p">,</span>
            <span class="n">kwmin</span><span class="o">=</span><span class="n">kwmin</span><span class="p">,</span>
            <span class="n">kwmax</span><span class="o">=</span><span class="n">kwmax</span><span class="p">,</span>
            <span class="n">indx</span><span class="o">=</span><span class="n">indx</span><span class="p">,</span>
            <span class="n">mcorr</span><span class="o">=</span><span class="n">mcorr</span><span class="p">,</span>
            <span class="n">projected</span><span class="o">=</span><span class="n">projected</span><span class="p">,</span>
            <span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dalpha</span> <span class="o">=</span> <span class="n">dalpha</span></div>

<div class="viewcode-block" id="StarCluster.calc_actions"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.calc_actions">[docs]</a>    <span class="k">def</span> <span class="nf">calc_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pot</span><span class="o">=</span><span class="n">MWPotential2014</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">vo</span><span class="o">=</span><span class="mf">220.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">JR</span><span class="p">,</span> <span class="n">Jphi</span><span class="p">,</span> <span class="n">Jz</span><span class="p">,</span> <span class="n">OR</span><span class="p">,</span> <span class="n">Ophi</span><span class="p">,</span> <span class="n">Oz</span><span class="p">,</span> <span class="n">TR</span><span class="p">,</span> <span class="n">Tphi</span><span class="p">,</span> <span class="n">Tz</span> <span class="o">=</span> <span class="n">calc_actions</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">pot</span><span class="o">=</span><span class="n">pot</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="n">ro</span><span class="p">,</span> <span class="n">vo</span><span class="o">=</span><span class="n">vo</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_actions</span><span class="p">(</span><span class="n">JR</span><span class="p">,</span> <span class="n">Jphi</span><span class="p">,</span> <span class="n">Jz</span><span class="p">,</span> <span class="n">OR</span><span class="p">,</span> <span class="n">Ophi</span><span class="p">,</span> <span class="n">Oz</span><span class="p">,</span> <span class="n">TR</span><span class="p">,</span> <span class="n">Tphi</span><span class="p">,</span> <span class="n">Tz</span><span class="p">)</span></div>

<div class="viewcode-block" id="StarCluster.vcirc_prof"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.StarCluster.vcirc_prof">[docs]</a>    <span class="k">def</span> <span class="nf">vcirc_prof</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">mmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">rmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">rmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">nrad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">emin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">emax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">kwmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">kwmax</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="n">indx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">projected</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="n">rprof</span><span class="p">,</span> <span class="n">vcprof</span><span class="p">,</span> <span class="n">rvmax</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">vcirc_prof</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">mmin</span><span class="o">=</span><span class="n">mmin</span><span class="p">,</span>
            <span class="n">mmax</span><span class="o">=</span><span class="n">mmax</span><span class="p">,</span>
            <span class="n">rmin</span><span class="o">=</span><span class="n">rmin</span><span class="p">,</span>
            <span class="n">rmax</span><span class="o">=</span><span class="n">rmax</span><span class="p">,</span>
            <span class="n">nrad</span><span class="o">=</span><span class="n">nrad</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
            <span class="n">emin</span><span class="o">=</span><span class="n">emin</span><span class="p">,</span>
            <span class="n">emax</span><span class="o">=</span><span class="n">emax</span><span class="p">,</span>
            <span class="n">kwmin</span><span class="o">=</span><span class="n">kwmin</span><span class="p">,</span>
            <span class="n">kwmax</span><span class="o">=</span><span class="n">kwmax</span><span class="p">,</span>
            <span class="n">indx</span><span class="o">=</span><span class="n">indx</span><span class="p">,</span>
            <span class="n">projected</span><span class="o">=</span><span class="n">projected</span><span class="p">,</span>
            <span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rvmax</span> <span class="o">=</span> <span class="n">rvmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span></div></div>


<div class="viewcode-block" id="sub_cluster"><a class="viewcode-back" href="../../../reference/clustertools.analysis.cluster.html#clustertools.analysis.cluster.sub_cluster">[docs]</a><span class="k">def</span> <span class="nf">sub_cluster</span><span class="p">(</span>
    <span class="n">cluster</span><span class="p">,</span>
    <span class="n">rmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">rmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">mmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">mmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">emin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">emax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">kwmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">kwmax</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">indx</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span>
    <span class="n">projected</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">reset_centre</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">reset_nbody_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">reset_nbody_mass</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">reset_nbody_radii</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">do_order</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">do_key_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    NAME:</span>

<span class="sd">       sub_cluster</span>

<span class="sd">    PURPOSE:</span>

<span class="sd">       Extract a sub population of stars from a StarCluster</span>
<span class="sd">       Notes:</span>
<span class="sd">        -- automatically moves cluster to centre of mass, so all constraints are in clustercentric coordinates and current cluster.units</span>

<span class="sd">    INPUT:</span>

<span class="sd">       rmin/rmax - minimum and maximum stellar radii</span>

<span class="sd">       mmin/mmax - minimum and maximum stellar mass</span>

<span class="sd">       vmin/vmax - minimum and maximum stellar velocity</span>

<span class="sd">       emin/emax - minimum and maximum stellar energy</span>

<span class="sd">       kwmin/kwmax - minimum and maximum stellar type (kw)</span>

<span class="sd">       indx - user defined boolean array from which to extract the subset</span>

<span class="sd">       projected - use projected values and constraints (default:False)</span>

<span class="sd">       reset_centre - re-calculate cluster centre after extraction (default:False)</span>

<span class="sd">    OUTPUT:</span>

<span class="sd">       instance</span>

<span class="sd">    HISTORY:</span>

<span class="sd">       2018 - Written - Webb (UofT)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">units0</span><span class="p">,</span> <span class="n">origin0</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">cluster</span><span class="o">.</span><span class="n">origin</span>
    <span class="n">cluster</span><span class="o">.</span><span class="n">to_centre</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">projected</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">rpro</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">vpro</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">r</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">v</span>

    <span class="k">if</span> <span class="n">rmin</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rmax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vmin</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vmax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mmin</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mmax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">emin</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">emax</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">eindx</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">etot</span> <span class="o">&lt;=</span> <span class="n">emax</span>
    <span class="k">elif</span> <span class="n">emin</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">emax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">eindx</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">etot</span> <span class="o">&gt;=</span> <span class="n">emin</span>
    <span class="k">elif</span> <span class="n">emin</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">emax</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">eindx</span> <span class="o">=</span> <span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">etot</span> <span class="o">&lt;=</span> <span class="n">emax</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">etot</span> <span class="o">&gt;=</span> <span class="n">emin</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">eindx</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">indx</span><span class="p">:</span>
        <span class="n">indx</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">indx</span> <span class="o">*=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">r</span> <span class="o">&gt;=</span> <span class="n">rmin</span><span class="p">)</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">rmax</span><span class="p">)</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">m</span> <span class="o">&gt;=</span> <span class="n">mmin</span><span class="p">)</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">m</span> <span class="o">&lt;=</span> <span class="n">mmax</span><span class="p">)</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">v</span> <span class="o">&gt;=</span> <span class="n">vmin</span><span class="p">)</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">v</span> <span class="o">&lt;=</span> <span class="n">vmax</span><span class="p">)</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">kw</span> <span class="o">&gt;=</span> <span class="n">kwmin</span><span class="p">)</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">kw</span> <span class="o">&lt;=</span> <span class="n">kwmax</span><span class="p">)</span>
        <span class="o">*</span> <span class="n">eindx</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">indx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">subcluster</span> <span class="o">=</span> <span class="n">StarCluster</span><span class="p">(</span>
            <span class="n">cluster</span><span class="o">.</span><span class="n">tphys</span><span class="p">,</span>
            <span class="n">units</span><span class="o">=</span><span class="n">cluster</span><span class="o">.</span><span class="n">units</span><span class="p">,</span>
            <span class="n">origin</span><span class="o">=</span><span class="n">cluster</span><span class="o">.</span><span class="n">origin</span><span class="p">,</span>
            <span class="n">ctype</span><span class="o">=</span><span class="n">cluster</span><span class="o">.</span><span class="n">ctype</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">subcluster</span><span class="o">.</span><span class="n">add_stars</span><span class="p">(</span>
            <span class="n">cluster</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
            <span class="n">cluster</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
            <span class="n">cluster</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
            <span class="n">cluster</span><span class="o">.</span><span class="n">vx</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
            <span class="n">cluster</span><span class="o">.</span><span class="n">vy</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
            <span class="n">cluster</span><span class="o">.</span><span class="n">vz</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
            <span class="n">cluster</span><span class="o">.</span><span class="n">m</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
            <span class="n">cluster</span><span class="o">.</span><span class="n">id</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">cluster</span><span class="o">.</span><span class="n">ctype</span> <span class="o">==</span> <span class="s2">&quot;observations&quot;</span><span class="p">:</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">dec</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">ra</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">dec</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">dist</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">pmra</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">pmdec</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">vlos</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">pmra</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">pmdec</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">vlos</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
            <span class="p">)</span>

        <span class="n">subcluster</span><span class="o">.</span><span class="n">kw</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">kw</span><span class="p">[</span><span class="n">indx</span><span class="p">]</span>

        <span class="n">subcluster</span><span class="o">.</span><span class="n">zmbar</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">zmbar</span>
        <span class="n">subcluster</span><span class="o">.</span><span class="n">rbar</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">rbar</span>
        <span class="n">subcluster</span><span class="o">.</span><span class="n">vstar</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">vstar</span>
        <span class="n">subcluster</span><span class="o">.</span><span class="n">tstar</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">tstar</span>
        <span class="n">subcluster</span><span class="o">.</span><span class="n">projected</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">projected</span>
        <span class="n">subcluster</span><span class="o">.</span><span class="n">centre_method</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">centre_method</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">logl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">add_sse</span><span class="p">(</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">kw</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">logl</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">logr</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">ep</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">ospin</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">id2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">bindx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">id1</span><span class="p">,</span> <span class="n">cluster</span><span class="o">.</span><span class="n">id</span><span class="p">[</span><span class="n">indx</span><span class="p">])</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">add_bse</span><span class="p">(</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">id1</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">id2</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">kw1</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">kw2</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">kcm</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">ecc</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">pb</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">semi</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">m1</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">m2</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">logl1</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">logl2</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">logr1</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">logr2</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">ep1</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">ep2</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">ospin1</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">ospin2</span><span class="p">[</span><span class="n">bindx</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">etot</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">add_energies</span><span class="p">(</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">kin</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span> <span class="n">cluster</span><span class="o">.</span><span class="n">pot</span><span class="p">[</span><span class="n">indx</span><span class="p">],</span> <span class="n">cluster</span><span class="o">.</span><span class="n">etot</span><span class="p">[</span><span class="n">indx</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">reset_centre</span><span class="p">:</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">add_orbit</span><span class="p">(</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">xgc</span> <span class="o">+</span> <span class="n">cluster</span><span class="o">.</span><span class="n">xc</span><span class="p">,</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">ygc</span> <span class="o">+</span> <span class="n">cluster</span><span class="o">.</span><span class="n">yc</span><span class="p">,</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">zgc</span> <span class="o">+</span> <span class="n">cluster</span><span class="o">.</span><span class="n">zc</span><span class="p">,</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">vxgc</span> <span class="o">+</span> <span class="n">cluster</span><span class="o">.</span><span class="n">vxc</span><span class="p">,</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">vygc</span> <span class="o">+</span> <span class="n">cluster</span><span class="o">.</span><span class="n">vyc</span><span class="p">,</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">vzgc</span> <span class="o">+</span> <span class="n">cluster</span><span class="o">.</span><span class="n">vzc</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">xc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">yc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">zc</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">vxc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">vyc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">vzc</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">xc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">yc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">zc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">vxc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">vyc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">vzc</span> <span class="o">=</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">find_centre</span><span class="p">(</span>
                <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">add_orbit</span><span class="p">(</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">xgc</span><span class="p">,</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">ygc</span><span class="p">,</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">zgc</span><span class="p">,</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">vxgc</span><span class="p">,</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">vygc</span><span class="p">,</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">vzgc</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">xc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">yc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">zc</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">xc</span><span class="p">,</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">yc</span><span class="p">,</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">zc</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">vxc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">vyc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">vzc</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">vxc</span><span class="p">,</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">vyc</span><span class="p">,</span>
                <span class="n">cluster</span><span class="o">.</span><span class="n">vzc</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">cluster</span><span class="o">.</span><span class="n">ctype</span> <span class="o">==</span> <span class="s2">&quot;observations&quot;</span><span class="p">:</span>
                <span class="n">subcluster</span><span class="o">.</span><span class="n">ra_gc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">dec_gc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">dist_gc</span> <span class="o">-</span> <span class="n">cluster</span><span class="o">.</span><span class="n">ra_gc</span><span class="p">,</span> <span class="n">cluster</span><span class="o">.</span><span class="n">dec_gc</span><span class="p">,</span> <span class="n">cluster</span><span class="o">.</span><span class="n">dist_gc</span>
                <span class="n">subcluster</span><span class="o">.</span><span class="n">pmra_gc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">pmdec_gc</span><span class="p">,</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">vlos_gc</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">cluster</span><span class="o">.</span><span class="n">pmra_gc</span><span class="p">,</span>
                    <span class="n">cluster</span><span class="o">.</span><span class="n">pmdec_gc</span><span class="p">,</span>
                    <span class="n">cluster</span><span class="o">.</span><span class="n">vlos_gc</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">reset_nbody_scale</span> <span class="ow">or</span> <span class="n">reset_nbody_mass</span> <span class="ow">or</span> <span class="n">reset_nbody_radii</span><span class="p">:</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">to_pckms</span><span class="p">()</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">key_params</span><span class="p">(</span><span class="n">do_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">reset_nbody_scale</span> <span class="ow">or</span> <span class="n">reset_nbody_mass</span><span class="p">:</span>
                <span class="n">subcluster</span><span class="o">.</span><span class="n">zmbar</span> <span class="o">=</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">mtot</span>
            <span class="k">if</span> <span class="n">reset_nbody_scale</span> <span class="ow">or</span> <span class="n">reset_nbody_radii</span><span class="p">:</span>
                <span class="n">subcluster</span><span class="o">.</span><span class="n">rbar</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">rm</span> <span class="o">/</span> <span class="mf">3.0</span>

            <span class="n">subcluster</span><span class="o">.</span><span class="n">vstar</span> <span class="o">=</span> <span class="mf">0.06557</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">subcluster</span><span class="o">.</span><span class="n">zmbar</span> <span class="o">/</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">rbar</span><span class="p">)</span>
            <span class="n">subcluster</span><span class="o">.</span><span class="n">tstar</span> <span class="o">=</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">rbar</span> <span class="o">/</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">vstar</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">subcluster</span> <span class="o">=</span> <span class="n">StarCluster</span><span class="p">(</span><span class="n">cluster</span><span class="o">.</span><span class="n">tphys</span><span class="p">)</span>

    <span class="n">cluster</span><span class="o">.</span><span class="n">to_origin</span><span class="p">(</span><span class="n">origin0</span><span class="p">)</span>
    <span class="n">cluster</span><span class="o">.</span><span class="n">to_units</span><span class="p">(</span><span class="n">units0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">subcluster</span><span class="o">.</span><span class="n">ntot</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">subcluster</span><span class="o">.</span><span class="n">to_origin</span><span class="p">(</span><span class="n">origin0</span><span class="p">)</span>
        <span class="n">subcluster</span><span class="o">.</span><span class="n">to_units</span><span class="p">(</span><span class="n">units0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">do_key_params</span><span class="p">:</span>
        <span class="n">subcluster</span><span class="o">.</span><span class="n">key_params</span><span class="p">(</span><span class="n">do_order</span><span class="o">=</span><span class="n">do_order</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">subcluster</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">clustertools 0.1.dev1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Jeremy J. Webb.
      Last updated on 22 Jun 2020.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>